<!-- Modal Overlay -->
@if (showModal) {
  <div class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4" (click)="close()">
    <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto" (click)="$event.stopPropagation()">
      <!-- Header -->
      <div class="px-6 py-4 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white">
        <h2 class="text-2xl font-bold text-gray-900">Add New Patient</h2>
        <button
          (click)="close()"
          class="text-gray-400 hover:text-gray-600 transition-colors"
          >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <!-- Form -->
      <form [formGroup]="patientForm" (ngSubmit)="onSubmit()" class="p-6">
        <div class="space-y-4">
          <!-- Name -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              Name <span class="text-red-500">*</span>
            </label>
            <input
              type="text"
              formControlName="name"
              class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              [class.border-red-500]="isFieldInvalid('name')"
              placeholder="Patient name"
              />
            </div>
            <!-- Age and Gender -->
            <div class="grid grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  Age <span class="text-red-500">*</span>
                </label>
                <input
                  type="number"
                  formControlName="age"
                  min="1"
                  max="150"
                  class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                  [class.border-red-500]="isFieldInvalid('age')"
                  />
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">
                    Gender <span class="text-red-500">*</span>
                  </label>
                  <select
                    formControlName="gender"
                    class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    [class.border-red-500]="isFieldInvalid('gender')"
                    >
                    <option value="">Select Gender</option>
                    @for (gender of genders; track gender) {
                      <option [value]="gender">{{ gender }}</option>
                    }
                  </select>
                </div>
              </div>
              <!-- Phone and Email -->
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">
                    Phone <span class="text-red-500">*</span>
                  </label>
                  <input
                    type="tel"
                    formControlName="phone"
                    class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    [class.border-red-500]="isFieldInvalid('phone')"
                    placeholder="+1 (555) 123-4567"
                    />
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <input
                      type="email"
                      formControlName="email"
                      class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                      [class.border-red-500]="isFieldInvalid('email')"
                      placeholder="patient@example.com"
                      />
                    </div>
                  </div>
                  <!-- Address -->
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Address</label>
                    <textarea
                      formControlName="address"
                      rows="2"
                      class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                      placeholder="Patient address"
                    ></textarea>
                  </div>
                  <!-- Medical History -->
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Medical History</label>
                    <textarea
                      formControlName="medicalHistory"
                      rows="3"
                      class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                      placeholder="Previous medical conditions, allergies, etc."
                    ></textarea>
                  </div>
                </div>
                <!-- Actions -->
                <div class="flex items-center justify-end gap-4 mt-6 pt-4 border-t">
                  <button
                    type="button"
                    (click)="close()"
                    class="px-6 py-2 text-gray-700 bg-gray-100 rounded-lg font-medium hover:bg-gray-200 transition-colors"
                    >
                    Cancel
                  </button>
                  <button
                    type="submit"
                    [disabled]="patientForm.invalid"
                    class="px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50"
                    >
                    Create Patient
                  </button>
                </div>
              </form>
            </div>
          </div>
        }
